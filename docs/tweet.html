<!DOCTYPE html>  <html> <head>   <title>tweet.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="about.html">                 about.coffee               </a>                                           <a class="source" href="archive.html">                 archive.coffee               </a>                                           <a class="source" href="article.html">                 article.coffee               </a>                                           <a class="source" href="config.html">                 config.coffee               </a>                                           <a class="source" href="home.html">                 home.coffee               </a>                                           <a class="source" href="likes.html">                 likes.coffee               </a>                                           <a class="source" href="rss.html">                 rss.coffee               </a>                                           <a class="source" href="tweet.html">                 tweet.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tweet.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>This module bakes the latest tweet snippet.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Require external dependencies.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">request = </span><span class="nx">require</span> <span class="s">&#39;request&#39;</span>
<span class="nv">jade = </span><span class="nx">require</span> <span class="s">&#39;jade&#39;</span>
<span class="nv">twitter = </span><span class="nx">require</span> <span class="s">&#39;twitter-text&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Request url. If request returns error, apply callback with error. Parse
body as JSON and get first tweet. If there's no tweet or the tweet 
contains no text return callback with error. Else apply jade compile with
auto linked text of first tweet and apply callback with src and result.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">bake = </span><span class="nf">(src, callback) -&gt;</span>
  <span class="nx">request</span> <span class="nx">src</span><span class="p">.</span><span class="nx">header</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nf">(err, resp, body) -&gt;</span>
    <span class="k">return</span> <span class="nx">callback</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>

    <span class="nv">tweets = </span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span> <span class="nx">body</span>
    <span class="nv">tweet = </span><span class="nx">tweets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="nx">callback</span> <span class="k">new</span> <span class="nb">Error</span> <span class="s">&#39;No tweet&#39;</span> <span class="nx">unless</span> <span class="nx">tweet</span><span class="o">?</span> <span class="o">and</span> <span class="nx">tweet</span><span class="p">.</span><span class="nx">text</span><span class="o">?</span>

    <span class="nv">text = </span><span class="nx">twitter</span><span class="p">.</span><span class="nx">autoLink</span> <span class="nx">tweet</span><span class="p">.</span><span class="nx">text</span>

    <span class="nv">options =</span>
      <span class="nv">filename: </span><span class="nx">src</span><span class="p">.</span><span class="nx">templatePath</span>
      <span class="nv">pretty: </span><span class="kc">true</span>

    <span class="nv">jadeCompile = </span><span class="nx">jade</span><span class="p">.</span><span class="nx">compile</span> <span class="nx">src</span><span class="p">.</span><span class="nx">template</span><span class="p">,</span> <span class="nx">options</span>

    <span class="nv">result = </span><span class="nx">jadeCompile</span>
      <span class="nv">text: </span><span class="nx">text</span>

    <span class="nx">callback</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">result</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Export API.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">exports.bake = </span><span class="nx">bake</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 